{
  "openapi":"3.0.3",
  "info":{
    "title":"selc-ms-core",
    "version":"1.0-SNAPSHOT"
  },
  "servers":[
    {
      "url":"{url}:{port}{basePath}",
      "variables":{
        "url":{
          "default":"http://localhost"
        },
        "port":{
          "default":"8080"
        },
        "basePath":{
          "default":""
        }
      }
    }
  ],
  "tags":[
    {
      "name":"External",
      "description":"External Controller"
    }
  ],
  "paths":{
    "/external/institutions/{externalId}":{
      "get":{
        "tags":[
          "External"
        ],
        "summary":"getByExternalId",
        "description":"The service retrieves the onboarded institution given its external id",
        "operationId":"getByExternalIdUsingGET",
        "parameters":[
          {
            "name":"externalId",
            "in":"path",
            "description":"Institution's unique external identifier",
            "required":true,
            "style":"simple",
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses":{
          "200":{
            "description":"OK",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/InstitutionResponse"
                }
              }
            }
          },
          "400":{
            "description":"Bad Request",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          },
          "404":{
            "description":"Not Found",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          },
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          }
        },
        "security":[
          {
            "bearerAuth":[
              "global"
            ]
          }
        ]
      }
    },
    "/external/institutions/{externalId}/products/{productId}/billing":{
      "get":{
        "tags":[
          "External"
        ],
        "summary":"getBillingInstitutionByExternalId",
        "description":"The service returns the billing data related to the institution even if the current user is not related to the institution/product",
        "operationId":"getBillingInstitutionByExternalIdUsingGET",
        "parameters":[
          {
            "name":"externalId",
            "in":"path",
            "description":"Institution's unique external identifier",
            "required":true,
            "style":"simple",
            "schema":{
              "type":"string"
            }
          },
          {
            "name":"productId",
            "in":"path",
            "description":"Product's unique identifier",
            "required":true,
            "style":"simple",
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses":{
          "200":{
            "description":"OK",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/InstitutionBillingResponse"
                }
              }
            }
          },
          "400":{
            "description":"Bad Request",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          },
          "404":{
            "description":"Not Found",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          },
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          }
        },
        "security":[
          {
            "bearerAuth":[
              "global"
            ]
          }
        ]
      }
    },
    "/external/institutions/{externalId}/products/{productId}/manager":{
      "get":{
        "tags":[
          "External"
        ],
        "summary":"getManagerInstitutionByExternalId",
        "description":"The service returns the manager related to the institution even if the current user is not related to the institution/product",
        "operationId":"getManagerInstitutionByExternalIdUsingGET",
        "parameters":[
          {
            "name":"externalId",
            "in":"path",
            "description":"Institution's unique external identifier",
            "required":true,
            "style":"simple",
            "schema":{
              "type":"string"
            }
          },
          {
            "name":"productId",
            "in":"path",
            "description":"Product's unique identifier",
            "required":true,
            "style":"simple",
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses":{
          "200":{
            "description":"OK",
            "content":{
              "application/json":{
                "schema":{
                  "$ref":"#/components/schemas/InstitutionManagerResponse"
                }
              }
            }
          },
          "400":{
            "description":"Bad Request",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          },
          "404":{
            "description":"Not Found",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          },
          "500":{
            "description":"Internal Server Error",
            "content":{
              "application/problem+json":{
                "schema":{
                  "$ref":"#/components/schemas/Problem"
                }
              }
            }
          }
        },
        "security":[
          {
            "bearerAuth":[
              "global"
            ]
          }
        ]
      }
    }
  },
  "components":{
    "schemas":{
      "AttributesResponse":{
        "title":"AttributesResponse",
        "type":"object",
        "properties":{
          "code":{
            "type":"string"
          },
          "description":{
            "type":"string"
          },
          "origin":{
            "type":"string"
          }
        }
      },
      "BillingResponse":{
        "title":"BillingResponse",
        "type":"object",
        "properties":{
          "publicServices":{
            "type":"boolean"
          },
          "recipientCode":{
            "type":"string"
          },
          "vatNumber":{
            "type":"string"
          }
        }
      },
      "DataProtectionOfficer":{
        "title":"DataProtectionOfficer",
        "type":"object",
        "properties":{
          "address":{
            "type":"string"
          },
          "email":{
            "type":"string"
          },
          "pec":{
            "type":"string"
          }
        }
      },
      "DataProtectionOfficerResponse":{
        "title":"DataProtectionOfficerResponse",
        "type":"object",
        "properties":{
          "address":{
            "type":"string"
          },
          "email":{
            "type":"string"
          },
          "pec":{
            "type":"string"
          }
        }
      },
      "GeoTaxonomies":{
        "title":"GeoTaxonomies",
        "type":"object",
        "properties":{
          "code":{
            "type":"string"
          },
          "desc":{
            "type":"string"
          },
          "enable":{
            "type":"boolean"
          }
        }
      },
      "InstitutionBillingResponse":{
        "title":"InstitutionBillingResponse",
        "type":"object",
        "properties":{
          "address":{
            "type":"string"
          },
          "billing":{
            "$ref":"#/components/schemas/BillingResponse"
          },
          "description":{
            "type":"string"
          },
          "digitalAddress":{
            "type":"string"
          },
          "externalId":{
            "type":"string"
          },
          "institutionId":{
            "type":"string"
          },
          "institutionType":{
            "type":"string",
            "enum":[
              "GSP",
              "PA",
              "PSP",
              "PT",
              "SCP"
            ]
          },
          "ipaCode":{
            "type":"string"
          },
          "origin":{
            "type":"string"
          },
          "pricingPlan":{
            "type":"string"
          },
          "taxCode":{
            "type":"string"
          },
          "zipCode":{
            "type":"string"
          }
        }
      },
      "InstitutionManagerResponse":{
        "title":"InstitutionManagerResponse",
        "type":"object",
        "properties":{
          "billingResponse":{
            "$ref":"#/components/schemas/BillingResponse"
          },
          "createdAt":{
            "type":"string",
            "format":"date-time"
          },
          "from":{
            "type":"string"
          },
          "id":{
            "type":"string"
          },
          "institutionUpdate":{
            "$ref":"#/components/schemas/InstitutionUpdate"
          },
          "pricingPlan":{
            "type":"string"
          },
          "product":{
            "$ref":"#/components/schemas/ProductInfo"
          },
          "role":{
            "type":"string"
          },
          "state":{
            "type":"string",
            "enum":[
              "ACTIVE",
              "DELETED",
              "PENDING",
              "REJECTED",
              "SUSPENDED",
              "TOBEVALIDATED"
            ]
          },
          "to":{
            "type":"string"
          },
          "updatedAt":{
            "type":"string",
            "format":"date-time"
          }
        }
      },
      "InstitutionResponse":{
        "title":"InstitutionResponse",
        "type":"object",
        "properties":{
          "address":{
            "type":"string"
          },
          "attributes":{
            "type":"array",
            "items":{
              "$ref":"#/components/schemas/AttributesResponse"
            }
          },
          "dataProtectionOfficer":{
            "$ref":"#/components/schemas/DataProtectionOfficerResponse"
          },
          "description":{
            "type":"string"
          },
          "digitalAddress":{
            "type":"string"
          },
          "externalId":{
            "type":"string"
          },
          "geographicTaxonomies":{
            "type":"array",
            "items":{
              "$ref":"#/components/schemas/GeoTaxonomies"
            }
          },
          "id":{
            "type":"string"
          },
          "institutionType":{
            "type":"string",
            "enum":[
              "GSP",
              "PA",
              "PG",
              "PSP",
              "PT",
              "SCP"
            ]
          },
          "ipaCode":{
            "type":"string"
          },
          "origin":{
            "type":"string"
          },
          "paymentServiceProviderResponse":{
            "$ref":"#/components/schemas/PaymentServiceProviderResponse"
          },
          "taxCode":{
            "type":"string"
          },
          "zipCode":{
            "type":"string"
          }
        }
      },
      "InstitutionUpdate":{
        "title":"InstitutionUpdate",
        "type":"object",
        "properties":{
          "address":{
            "type":"string"
          },
          "dataProtectionOfficer":{
            "$ref":"#/components/schemas/DataProtectionOfficer"
          },
          "description":{
            "type":"string"
          },
          "digitalAddress":{
            "type":"string"
          },
          "geographicTaxonomyCodes":{
            "type":"array",
            "items":{
              "type":"string"
            }
          },
          "institutionType":{
            "type":"string",
            "enum":[
              "GSP",
              "PA",
              "PG",
              "PSP",
              "PT",
              "SCP"
            ]
          },
          "paymentServiceProvider":{
            "$ref":"#/components/schemas/PaymentServiceProvider"
          },
          "taxCode":{
            "type":"string"
          },
          "zipCode":{
            "type":"string"
          }
        }
      },
      "PaymentServiceProvider":{
        "title":"PaymentServiceProvider",
        "type":"object",
        "properties":{
          "abiCode":{
            "type":"string"
          },
          "businessRegisterNumber":{
            "type":"string"
          },
          "legalRegisterName":{
            "type":"string"
          },
          "legalRegisterNumber":{
            "type":"string"
          },
          "vatNumberGroup":{
            "type":"boolean"
          }
        }
      },
      "PaymentServiceProviderResponse":{
        "title":"PaymentServiceProviderResponse",
        "type":"object",
        "properties":{
          "abiCode":{
            "type":"string"
          },
          "businessRegisterNumber":{
            "type":"string"
          },
          "legalRegisterName":{
            "type":"string"
          },
          "legalRegisterNumber":{
            "type":"string"
          },
          "vatNumberGroup":{
            "type":"boolean"
          }
        }
      },
      "Problem":{
        "title":"Problem",
        "type":"object",
        "properties":{
          "detail":{
            "type":"string"
          },
          "errors":{
            "type":"array",
            "items":{
              "$ref":"#/components/schemas/ProblemError"
            }
          },
          "status":{
            "type":"integer",
            "format":"int32"
          },
          "title":{
            "type":"string"
          },
          "type":{
            "type":"string"
          }
        }
      },
      "ProblemError":{
        "title":"ProblemError",
        "type":"object",
        "properties":{
          "code":{
            "type":"string"
          },
          "detail":{
            "type":"string"
          }
        }
      },
      "ProductInfo":{
        "title":"ProductInfo",
        "type":"object",
        "properties":{
          "createdAt":{
            "type":"string",
            "format":"date-time"
          },
          "id":{
            "type":"string"
          },
          "role":{
            "type":"array",
            "items":{
              "type":"string"
            }
          }
        }
      }
    },
    "securitySchemes":{
      "bearerAuth":{
        "type":"http",
        "description":"A bearer token in the format of a JWS and conformed to the specifications included in [RFC8725](https://tools.ietf.org/html/RFC8725)",
        "scheme":"bearer",
        "bearerFormat":"JWT"
      }
    }
  }
}